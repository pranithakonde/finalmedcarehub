<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src='https://kit.fontawesome.com/a076d05399.js' crossorigin='anonymous'></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <title>Daily Fitness & Health Monitoring</title>
  <!-- Include Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Include Bootstrap Icons CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/tooplate-mini-finance.css">
  <link rel="stylesheet" href="C:\\Users\\venka\\Desktop\\doctorproj\\trialfol\\css\\tooplate-mini-finance.css">


  <style>
    .card-icon {
      font-size: 2.5rem;
    }
    .fitness-icon {
      color: #007bff; /* Blue for fitness activities */
    }
    .health-icon {
      color: #28a745; /* Green for health stats */
    }
    .medical-icon {
      color: #dc3545; /* Red for medical assistance */
    }
    .value {
      font-size: 1.25rem;
      font-weight: bold;
      margin-top: 0.5rem;
    }
  </style>
  <!-- CSS FILES -->      
  <link rel="preconnect" href="https://fonts.googleapis.com">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@300;400;700&display=swap" rel="stylesheet">

  <link href="css/bootstrap.min.css" rel="stylesheet">

  <link href="css/bootstrap-icons.css" rel="stylesheet">

  <link href="css/apexcharts.css" rel="stylesheet">

  <link href="css/tooplate-mini-finance.css" rel="stylesheet">
</head>
<body>
    <header class="navbar sticky-top flex-md-nowrap">
        <div class="col-md-3 col-lg-3 me-0 px-3 fs-6">
            <a class="navbar-brand" href="a.html">
                <i class="bi-box"></i>
                Med Care
            </a>
        </div>

        <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <form class="custom-form header-form ms-lg-3 ms-md-3 me-lg-auto me-md-auto order-2 order-lg-0 order-md-0" action="#" method="get" role="form">
            <input class="form-control" name="search" type="text" placeholder="Search" aria-label="Search">
        </form>

        <div class="navbar-nav me-lg-2">
            <div class="nav-item text-nowrap d-flex align-items-center">
                <div class="dropdown ps-3">
                    <a class="nav-link dropdown-toggle text-center" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false" id="navbarLightDropdownMenuLink">
                        <i class="bi-bell"></i>
                        <span class="position-absolute start-100 translate-middle p-1 bg-danger border border-light rounded-circle">
                            <span class="visually-hidden">New alerts</span>
                        </span>
                    </a>

                    

                </div>

                <div class="dropdown ps-1">
                    <a class="nav-link dropdown-toggle text-center" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="bi-three-dots-vertical"></i>
                    </a>


                </div>

                <div class="dropdown px-3">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <img src="images/medium-shot-happy-man-smiling.jpg" class="profile-image img-fluid" alt="">
                    </a>
                    
                </div>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-3 d-md-block sidebar collapse">
                <div class="position-sticky py-4 px-3 sidebar-sticky">
                    <ul class="nav flex-column h-100">
                        

                        <li class="nav-item">
                            <a class="nav-link" href="a.html">
                                <i class="bi-heart-pulse me-2"></i>
                                Health Tracker
                            </a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="#">
                                <i class="bi-wallet me-2"></i>
                                Wallet
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">
                                <i class="bi-person me-2"></i>
                                Profile
                            </a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="#">
                                <i class="bi-gear me-2"></i>
                                Settings
                            </a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="#">
                                <i class="bi-question-circle me-2"></i>
                                Help Center
                            </a>
                        </li>

                        
                    </ul>
                </div>
            </nav>
            <main class="main-wrapper col-md-9 ms-sm-auto py-4 col-lg-9 px-md-4 border-start">
                <div class="row my-4">
                        <div class="container my-5">
                            <h3 class="text-center mb-4">Daily Monitoring for Fitness & Health</h3>
                        
                            <!-- Fitness Section -->
                            <section id="fitness" class="mb-5">
                              <h5 class="mb-3"><i class="bi-bar-chart me-2 fitness-icon"></i>Fitness Activities</h5>
                              <div class="row">
                                <div class="col-md-4">
                                  <div class="card shadow-sm">
                                    <div class="card-body text-center">
                                      <i class="bi-watch card-icon fitness-icon"></i>
                                      <h5 class="card-title mt-3">Steps</h5>

        <pre id="realTimeSteps" class="value">Loading...</pre>
        <!-- <p class="value">1578</p> -->
        <p class="card-text">Track your daily steps and set goals to stay active.</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card shadow-sm">
      <div class="card-body text-center">
        <i class="bi-fire card-icon fitness-icon"></i>
        <h5 class="card-title mt-3">Calories Burned</h5>

        <pre id="realTimeCalories" class="value">Loading...</pre>
        <!-- <p class="value">3 L</p> -->
        <p class="card-text">Keep track of calories burned during Your exercises.</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card shadow-sm">
      <div class="card-body text-center">
        <!-- <i class="bi-fire card-icon fitness-icon"></i> -->
        <i class="bi-geo-alt card-icon fitness-icon"></i> <!-- Location Pin -->

        <h5 class="card-title mt-3">Distance Traveled</h5>
        <h2></h2>
        <pre id="realTimeDistance" class="value">Loading...</pre>
        <p class="card-text">Keep track of distance travelled to stay active.</p>
      </div>
    </div>
  </div>
  <div class="col-md-4 mt-4">
      <div class="card shadow-sm">
        <div class="card-body text-center">
            <i class="bi-heart-pulse card-icon fitness-icon"></i>
            
          <h5 class="card-title mt-3">Heart Rate</h5>
        <h2></h2>
<pre id="realTimeHeartRate" class="value">75 bpm</pre>
<!-- <p class="value">45 min</p> -->
                                        <p class="card-text">Monitor your heart rate to stay on top of your health.</p>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-md-4 mt-4">
                                    <div class="card shadow-sm">
                                      <div class="card-body text-center">
                                       
                                        <i class="bi-thermometer-half card-icon fitness-icon"></i>

                                        <h5 class="card-title mt-3">Body Temperature</h5>
<!-- <h2>Body Temperature</h2> -->
<pre id="realTimeBodyTemperature" class="value">36.5 Â°C</pre>
<p class="card-text">Track your body temperature</p>
</div>
</div>
</div>
<div class="col-md-4 mt-4">
<div class="card shadow-sm">
  <div class="card-body text-center">
    <i class="bi-speedometer card-icon fitness-icon"></i>

    <h5 class="card-title mt-3">Blood Pressure</h5>
    <!-- <p class="value">2.5 km</p> -->
<!-- <h2>Blood Pressure</h2> -->
<pre id="realTimeBloodPressure" class="value">120/80 mmHg</pre>
<p class="card-text">Keep track of your blood pressure for a healthier heart.</p>
</div>
</div>
</div>
<div class="col-md-4 mt-4">
<div class="card shadow-sm">
  <div class="card-body text-center">
    <i class="bi-moon-stars card-icon fitness-icon"></i>

    <h5 class="card-title mt-3">Avg Sleep</h5>
    <!-- <p class="value">2.5 km</p> -->
<!-- <h2> Avg Sleep</h2> -->
<pre id="realTimeSleep" class="value">7 hr</pre>
<p class="card-text">Keep track of your sleep for a healthier lifestyle.</p>

    </div>
    </div>
    </div>

    <!-- History Data Section -->
    <!-- <div id="history">
        <h2>History Data</h2>
        <pre id="historyData">Loading...</pre>
    </div> -->

    <script>
        // Helper function to convert UTC time to IST
        function convertUTCToIST(utcTime) {
            const utcDate = new Date(utcTime);  // Create Date object from UTC time
            const offset = 5.5 * 60 * 60 * 1000; // IST offset in milliseconds (UTC+5:30)
            const istDate = new Date(utcDate.getTime() + offset);  // Convert to IST
            return istDate.toLocaleString(); // Format date to readable string in IST
        }

        // Function to fetch Google Fit data
        async function fetchData() {
            try {
                const response = await fetch('/retrieve-google-fit-data');
                const data = await response.json();

                // Extract relevant information (steps, calories, distance, etc.)
                let steps = 0;
                let calories = 0;
                let distance = 0;
                let timestamp = ''; // Variable to store timestamp

                // Loop through the 'bucket' to get the data
                data.bucket.forEach(bucket => {
                    bucket.dataset.forEach(dataset => {
                        dataset.point.forEach(point => {
                            point.value.forEach(value => {
                                if (point.dataTypeName === 'com.google.step_count.delta') {
                                    steps += value.intVal || 0;  // Add step count value
                                }
                                
                                if (point.dataTypeName === 'com.google.calories.expended') {
                                    calories += value.fpVal || 0;  // Add calories value
                                }
                                if (point.dataTypeName === 'com.google.distance.delta') {
                                    distance += value.fpVal || 0;  // Add distance value in meters
                                }
                                
                                // Extract timestamp from the first point (assuming points have the same timestamp)
                                timestamp = convertUTCToIST(point.startTimeNanos / 1000000);  // Convert nanoseconds to milliseconds and then to IST
                            });
                        });
                    });
                });

                // Display the data in the real-time section
                document.getElementById('realTimeSteps').textContent = `${steps}`;
                document.getElementById('realTimeCalories').textContent = `${calories.toFixed(2)} kcal`;
                document.getElementById('realTimeDistance').textContent = `${distance.toFixed(2)} meters`;

            } catch (error) {
                console.error('Error fetching real-time data:', error);
                document.getElementById('realTimeSteps').textContent = 'Failed to load steps.';
                document.getElementById('realTimeCalories').textContent = 'Failed to load calories.';
                document.getElementById('realTimeDistance').textContent = 'Failed to load distance.';
            }
        }

      
        // Fetch data every 30 seconds
        setInterval(() => {
            fetchData(); // Update real-time data
// Update history data
        }, 30000); // 30 seconds in milliseconds

        // Initial data load
        fetchData();
   
    </script>
</body>
</html>
